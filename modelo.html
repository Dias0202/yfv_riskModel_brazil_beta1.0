<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Yellow Fever – Model & Metrics</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <link rel="stylesheet" href="css/styles.css" />
  
  <style>
    .model-container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 2rem 1.5rem;
      font-family: "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      color: #333;
    }

    /* Estilo dos Blocos de Seção */
    .section-block {
      background: #fff;
      padding: 2.5rem;
      margin-bottom: 2.5rem;
      border-radius: 8px;
      border: 1px solid #e0e0e0;
      box-shadow: 0 4px 6px rgba(0,0,0,0.02);
    }

    h2 {
      border-bottom: 2px solid #007bff;
      padding-bottom: 12px;
      margin-top: 0;
      margin-bottom: 25px;
      color: #2c3e50;
      font-size: 1.8rem;
    }

    h3 {
      color: #444;
      margin-top: 1.5rem;
      font-size: 1.3rem;
      border-left: 4px solid #007bff;
      padding-left: 10px;
    }

    p, li {
      line-height: 1.7;
      font-size: 1rem;
      color: #4a4a4a;
    }

    /* Grid de Métricas (Cards) */
    .metric-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    .metric-card {
      background: #f8f9fa;
      padding: 1.5rem;
      border-radius: 8px;
      border: 1px solid #dee2e6;
      text-align: center;
      transition: transform 0.2s;
    }

    .metric-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(0,0,0,0.05);
      border-color: #007bff;
    }

    .metric-card h4 {
      margin: 0;
      color: #666;
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .metric-card .value {
      display: block;
      margin-top: 0.5rem;
      font-size: 2.2rem;
      font-weight: 700;
      color: #2c3e50;
    }

    .metric-card .desc {
      display: block;
      margin-top: 0.5rem;
      font-size: 0.85rem;
      color: #888;
    }

    /* Layout de Imagens e Figuras */
    .figure-container {
      margin: 2rem 0;
      text-align: center;
    }

    .figure-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2rem;
      align-items: start;
      margin-bottom: 2rem;
    }

    .figure-item {
      background: #fafafa;
      padding: 1rem;
      border: 1px solid #eee;
      border-radius: 8px;
    }

    .figure-item img {
      width: 100%;
      height: auto;
      border-radius: 4px;
    }

    .figure-caption {
      margin-top: 1rem;
      font-size: 0.9rem;
      color: #666;
      text-align: left;
      padding: 0 0.5rem;
    }
    
    /* Controle de tamanho para as imagens centrais */
    .figure-central-img {
        width: 100%;
        height: auto;
        border-radius: 4px;
        display: block;
        margin: 0 auto;
    }

    /* Tabela Técnica */
    .tech-table {
      width: 100%;
      border-collapse: collapse;
      margin: 1.5rem 0;
      font-size: 0.95rem;
    }
    .tech-table th, .tech-table td {
      padding: 12px 15px;
      border-bottom: 1px solid #e0e0e0;
      text-align: left;
    }
    .tech-table thead th {
      background-color: #f1f3f5;
      color: #333;
      font-weight: 600;
    }

    @media (max-width: 768px) {
      .figure-row {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <header class="site-header">
    <h1>Yellow Fever Risk Modelling – Brazil</h1>
    <nav class="site-nav">
      <a href="index.html">Home</a>
      <a href="scenarios.html">Scenarios</a>
      <a href="casos.html">Data visualization</a>
      <a href="modelo.html" class="active">Model & Metrics</a>
      <a href="about.html">Data & documentation</a>
    </nav>
  </header>

  <main class="model-container">
    
    <section class="section-block">
      <h2>Experimental Design & Model Selection</h2>
      <p>
        The objective of this study was to develop a predictive model for the occurrence of Sylvatic Yellow Fever (YF) outbreaks in Brazilian municipalities (1994–2025) and project risks for future scenarios (2021–2040).
        This is a <strong>binary classification problem</strong> where the positive class (1) represents the occurrence of at least one confirmed YF case (human or epizootic) in a given municipality-period cluster.
      </p>
      
      <h3>Algorithm Comparison</h3>
      <p>
        We evaluated four distinct algorithms using Stratified K-Fold Cross-Validation (k=5) to ensure robustness against spatial and temporal autocorrelation. The <strong>Random Forest Classifier</strong> was selected as the final model due to its superior capability in handling non-linear relationships between climatic variables and epidemiological outcomes, as well as its resistance to overfitting in high-dimensional feature spaces.
      </p>
      <table class="tech-table">
        <thead>
          <tr>
            <th>Algorithm</th>
            <th>ROC-AUC (Mean)</th>
            <th>Key Advantage/Disadvantage</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>Random Forest (Selected)</strong></td>
            <td><strong>0.93</strong></td>
            <td>High discriminative power; captures complex interactions (e.g., climate × vegetation).</td>
          </tr>
          <tr>
            <td>XGBoost</td>
            <td>0.91</td>
            <td>Competitive performance but required extensive hyperparameter tuning.</td>
          </tr>
          <tr>
            <td>Gradient Boosting</td>
            <td>0.89</td>
            <td>Slower training time; marginally lower sensitivity than RF.</td>
          </tr>
          <tr>
            <td>Logistic Regression</td>
            <td>0.82</td>
            <td>Good baseline but failed to capture non-linear climatic thresholds.</td>
          </tr>
        </tbody>
      </table>
    </section>

    <section class="section-block">
      <h2>Model Performance & Validation</h2>
      <p>
        Given the epidemiological context, where <strong>False Negatives (missing an outbreak)</strong> have severe public health consequences (loss of life), we optimized the model decision threshold using the <strong>F2-Score</strong>. This metric weighs Recall (Sensitivity) higher than Precision.
      </p>

      <div class="metric-grid">
        <div class="metric-card">
          <h4>ROC-AUC</h4>
          <span class="value">0.93</span>
          <span class="desc">Outstanding discrimination</span>
        </div>
        <div class="metric-card">
          <h4>Recall (Sensitivity)</h4>
          <span class="value">~72%</span>
          <span class="desc">Outbreaks correctly detected</span>
        </div>
        <div class="metric-card">
          <h4>F2-Score</h4>
          <span class="value">Optimized</span>
          <span class="desc">Prioritizing safety over precision</span>
        </div>
        <div class="metric-card">
          <h4>Threshold</h4>
          <span class="value">0.16</span>
          <span class="desc">Low barrier for risk alert</span>
        </div>
      </div>

      <div class="figure-row">
        <div class="figure-item">
          <img src="img/roc_curve.png" alt="ROC Curve">
          <div class="figure-caption">
            <strong>Figure 1: Receiver Operating Characteristic (ROC) Curve.</strong>
            The AUC of 0.93 indicates that the model has a 93% probability of ranking a municipality with a YF outbreak higher than one without. The curve hugs the top-left corner, demonstrating high sensitivity while maintaining specificity.
          </div>
        </div>
        <div class="figure-item">
          <img src="img/pr_curve.png" alt="Precision-Recall Curve">
          <div class="figure-caption">
            <strong>Figure 2: Precision-Recall (PR) Curve.</strong>
            With an Average Precision (AP) of 0.53, the model faces the challenge of class imbalance (outbreaks are rare events). The curve shows the trade-off: to achieve high recall (>0.7), precision drops, reflecting the conservative nature of the model.
          </div>
        </div>
      </div>

      <div class="figure-container">
        <h3>Decision Strategy: The Confusion Matrix</h3>
        <div style="max-width: 450px; margin: 0 auto;">
          <img src="img/confusion_matrix.png" alt="Confusion Matrix" class="figure-central-img">
        </div>
        <div class="figure-caption" style="max-width: 800px; margin: 1rem auto; text-align: justify;">
          <strong>Figure 3: Confusion Matrix (Test Set).</strong>
          By setting a low probability threshold (0.16), the model correctly identified <strong>166 outbreaks (True Positives)</strong> while missing only 64. This results in 333 <strong>False Positives</strong> (municipalities flagged as risky where no outbreak occurred). In public health terms, these False Positives represent "preventive alerts"—areas that are environmentally suitable for YF and should be prioritized for vaccination, even if no case has been reported yet.
        </div>
      </div>
    </section>

    <section class="section-block">
      <h2>Ecological Drivers of Risk</h2>
      <p>
        The feature importance analysis (Gini impurity reduction) reveals the biological and demographic mechanisms driving the model's predictions.
      </p>

      <div class="figure-container">
        <div style="max-width: 600px; margin: 0 auto;">
          <img src="img/feature_importance.png" alt="Feature Importance Plot" class="figure-central-img">
        </div>
        <div class="figure-caption" style="max-width: 800px; margin: 1rem auto;">
          <strong>Figure 4: Top 15 Predictors of Yellow Fever Risk.</strong>
        </div>
      </div>

      <h3>Interpretation of Key Predictors</h3>
      <ul style="list-style-type: disc; padding-left: 20px;">
        <li><strong>Temporal Dynamics (cluster_C4_2015_2019):</strong> The strongest predictor, capturing the massive silvatic expansion wave that occurred in Southeast Brazil during this period.</li>
        <li><strong>Precipitation (ppt_mean) & Temperature (tmax_mean):</strong> These are critical abiotic factors for the vector lifecycle (<em>Haemagogus</em> and <em>Sabethes</em> mosquitoes). Rainfall enables breeding sites, while temperature accelerates viral replication within the mosquito (extrinsic incubation period).</li>
        <li><strong>Immunological Landscape (not_vaccinated_pct):</strong> Areas with large pockets of unvaccinated populations act as fuel for viral amplification. The model correctly identifies that low vaccination coverage is a critical vulnerability.</li>
        <li><strong>Population Density & Urban Interface:</strong> Variables like <code>pop_density_last</code> and <code>Urban_area</code> highlight the risk at the peri-urban interface, where humans come into contact with the silvatic cycle.</li>
      </ul>
    </section>

    <section class="section-block">
      <h2>Future Scenarios Methodology (2021–2040)</h2>
      <p>
        To project risk into the future, we developed a simulation framework based on the <strong>SSP2-4.5</strong> climate change pathway (IPCC AR6). Since future biological data is unavailable, we applied mathematical transformations to the baseline features to create synthetic future states.
      </p>

      <table class="tech-table">
        <thead>
          <tr>
            <th style="width: 25%;">Variable Group</th>
            <th>Simulation Logic (SSP2-4.5 Proxy)</th>
            <th>Rationale</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>Temperature</strong></td>
            <td><code>tmax_mean + 1.5°C</code></td>
            <td>Consistent with near-term warming projections for Brazil under intermediate emissions.</td>
          </tr>
          <tr>
            <td><strong>Precipitation</strong></td>
            <td><code>ppt_mean × 0.95</code> (-5%)</td>
            <td>Simulates the trend of reduced rainfall and increased drought frequency in tropical areas.</td>
          </tr>
          <tr>
            <td><strong>Vapor Pressure (VPD)</strong></td>
            <td><code>vpd_mean × 1.05</code> (+5%)</td>
            <td>Drier air increases water stress, affecting vector survival and forest health.</td>
          </tr>
          <tr>
            <td><strong>Demography</strong></td>
            <td><code>pop_absolute × 1.15</code> (Scenario D)</td>
            <td>Projected population growth, increasing the number of people exposed to the silvatic cycle.</td>
          </tr>
          <tr>
            <td><strong>Vaccination</strong></td>
            <td>Dynamic (±20%)</td>
            <td>Scenarios B and C simulate the success or failure of public health campaigns (PNI).</td>
          </tr>
        </tbody>
      </table>
      
      <p style="font-size: 0.9rem; margin-top: 1rem; padding: 1rem; background: #fff3cd; border: 1px solid #ffeeba; border-radius: 4px; color: #856404;">
        <strong>Note:</strong> These scenarios are <em>simulations of sensitivity</em>. They answer "What if?" questions (e.g., "What if vaccination drops 20% while the climate warms?") rather than providing deterministic forecasts.
      </p>
    </section>

  </main>
</body>
</html>

